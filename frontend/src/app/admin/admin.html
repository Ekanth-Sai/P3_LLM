<div class="admin-container">
    <nav class="navbar">
        <div class="nav-left">Admin Dashboard</div>
        <div class="nav-right" (click)="goBackToDashboard()" style="cursor:pointer">Home</div>
    </nav>

    <div *ngIf="message" [ngClass]="{'message-success': messageType === 'success', 'message-error': messageType === 'error'}">
        {{message}}
    </div>

    <div class="dashboard-content" *ngIf="view==='dashboard'">
        <h2>Welcome to the Admin Dashboard</h2>
        <p>Select an option below to manage users:</p>
        <div class="dropdown-card">
            <select [(ngModel)]="selectedOption" (change)="navigateToPage()">
                <option disabled selected value="">Choose an Option</option>
                <option value="pending">Pending Requests</option>
                <option value="users">Existing Users</option>
                <option value="bot-usage">Bot Usage</option>
            </select>
        </div>
    </div>

    <div class="table-card" *ngIf="view==='existing'">
        <h3>Existing Users</h3>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of users">
                    <td>{{user.id}}</td>
                    <td><input [(ngModel)]="user.email" /></td>
                    <td>
                        <select [(ngModel)]="user.role">
                            <option value="USER">USER</option>
                            <option value="ADMIN">ADMIN</option>
                        </select>
                    </td>
                    <td><button (click)="updateUser(user)">Update</button></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="table-card" *ngIf="view==='pending'">
        <h3>Pending User Requests</h3>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Email</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of pendingUsers">
                    <td>{{user.id}}</td>
                    <td>{{user.email}}</td>
                    <td>
                        <button class="accept-btn" (click)="handlePending(user, 'accept')">Accept</button>
                        <button class="decline-btn" (click)="handlePending(user, 'decline')">Decline</button>
                    </td>
                </tr>
                <tr *ngIf="decliningUser">
                    <td colspan="3">
                        <div>
                            <textarea [(ngModel)]="declineReason" placeholder="Reason for declining {{decliningUser.email}}..."></textarea>
                            <button (click)="confirmDecline()">Confirm Decline</button>
                            <button (click)="cancelDecline()">Cancel</button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <form (submit)="onFileUpload($event)">
        <input type="file" (change)="onFileSelected($event)" />
        <button type="submit">Upload File</button>
    </form>

    <div *ngFor="let file of files">
        <span>{{file.filename}}</span>
        <button (click)="downloadFile(file)">Download File</button>
    </div>
</div>